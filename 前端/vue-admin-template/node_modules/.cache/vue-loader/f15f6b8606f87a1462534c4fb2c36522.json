{"remainingRequest":"E:\\demo\\谷粒课堂\\前端\\vue-admin-template\\node_modules\\vue-loader\\lib\\index.js??vue-loader-options!E:\\demo\\谷粒课堂\\前端\\vue-admin-template\\src\\views\\edu\\teacher\\form.vue?vue&type=script&lang=js&","dependencies":[{"path":"E:\\demo\\谷粒课堂\\前端\\vue-admin-template\\src\\views\\edu\\teacher\\form.vue","mtime":1662618384584},{"path":"E:\\demo\\谷粒课堂\\前端\\vue-admin-template\\node_modules\\cache-loader\\dist\\cjs.js","mtime":499162500000},{"path":"E:\\demo\\谷粒课堂\\前端\\vue-admin-template\\node_modules\\babel-loader\\lib\\index.js","mtime":315532800000},{"path":"E:\\demo\\谷粒课堂\\前端\\vue-admin-template\\node_modules\\cache-loader\\dist\\cjs.js","mtime":499162500000},{"path":"E:\\demo\\谷粒课堂\\前端\\vue-admin-template\\node_modules\\vue-loader\\lib\\index.js","mtime":499162500000}],"contextDependencies":[],"result":[{"type":"Buffer","data":"base64:Ly8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KDQppbXBvcnQgdGVhY2hlciBmcm9tICJAL2FwaS9lZHUvdGVhY2hlciI7DQppbXBvcnQgSW1hZ2VDcm9wcGVyIGZyb20gIkAvY29tcG9uZW50cy9JbWFnZUNyb3BwZXIiOw0KaW1wb3J0IFBhblRodW1iIGZyb20gIkAvY29tcG9uZW50cy9QYW5UaHVtYiI7DQoNCmNvbnN0IGRlZmF1bHRGb3JtID0gew0KICBuYW1lOiAiIiwNCiAgc29ydDogMCwNCiAgbGV2ZWw6ICIiLA0KICBjYXJlZXI6ICIiLA0KICBpbnRybzogIiIsDQogIGF2YXRhcjogIiIsDQp9Ow0KDQpleHBvcnQgZGVmYXVsdCB7DQogIGRhdGEoKSB7DQogICAgcmV0dXJuIHsNCiAgICAgIHRlYWNoZXI6IHsNCiAgICAgICAgbmFtZTogIiIsDQogICAgICAgIHNvcnQ6IDAsDQogICAgICAgIGxldmVsOiAxLA0KICAgICAgICBjYXJlZXI6ICIiLA0KICAgICAgICBpbnRybzogIiIsDQogICAgICAgIGF2YXRhcjogcHJvY2Vzcy5lbnYuT1NTX1BBVEggKyAiL1RlYWNoZXJIZWFkUG9ydHJhaXQv6buY6K6k5aS05YOPLmpwZyIsDQogICAgICB9LA0KICAgICAgc2F2ZUJ0bkRpc2FibGVkOiBmYWxzZSwgLy8g5L+d5a2Y5oyJ6ZKu5piv5ZCm56aB55SoLA0KICAgICAgQkFTRV9BUEk6IHByb2Nlc3MuZW52LlZVRV9BUFBfQkFTRV9BUEksIC8vIOaOpeWPo0FQSeWcsOWdgA0KICAgICAgaW1hZ2Vjcm9wcGVyU2hvdzogZmFsc2UsIC8vIOaYr+WQpuaYvuekuuS4iuS8oOe7hOS7tg0KICAgICAgaW1hZ2Vjcm9wcGVyS2V5OiAwLCAvLyDkuIrkvKDnu4Tku7ZpZA0KICAgIH07DQogIH0sDQogIGNvbXBvbmVudHM6IHsNCiAgICBJbWFnZUNyb3BwZXI6IEltYWdlQ3JvcHBlciwNCiAgICBQYW5UaHVtYjogUGFuVGh1bWIsDQogIH0sDQoNCiAgd2F0Y2g6IHsNCiAgICAkcm91dGUodG8sIGZyb20pIHsNCiAgICAgIGNvbnNvbGUubG9nKCJ3YXRjaCAkcm91dGUiKTsNCiAgICAgIHRoaXMuaW5pdCgpOw0KICAgIH0sDQogIH0sDQoNCiAgY3JlYXRlZCgpIHsNCiAgICAvL2NvbnNvbGUubG9nKCdjcmVhdGVkJykNCiAgICB0aGlzLmluaXQoKTsNCiAgfSwNCg0KICBtZXRob2RzOiB7DQogICAgaW5pdCgpIHsNCiAgICAgIGlmICh0aGlzLiRyb3V0ZS5wYXJhbXMgJiYgdGhpcy4kcm91dGUucGFyYW1zLmlkKSB7DQogICAgICAgIGNvbnN0IGlkID0gdGhpcy4kcm91dGUucGFyYW1zLmlkOw0KICAgICAgICB0aGlzLmZldGNoRGF0YUJ5SWQoaWQpOw0KICAgICAgfSBlbHNlIHsNCiAgICAgICAgLy8g5L2/55So5a+56LGh5ouT5bGV6L+Q566X56ym77yM5ou36LSd5a+56LGh77yM6ICM5LiN5piv5byV55So77yMDQogICAgICAgIC8vIOWQpuWImeaWsOWinuS4gOadoeiusOW9leWQju+8jGRlZmF1bHRGb3Jt5bCx5Y+Y5oiQ5LqG5LmL5YmN5paw5aKe55qEdGVhY2hlcueahOWAvA0KICAgICAgICB0aGlzLnRlYWNoZXIgPSB7IC4uLmRlZmF1bHRGb3JtIH07DQogICAgICB9DQogICAgfSwNCg0KICAgIC8vIOagueaNrmlk5p+l6K+i6K6w5b2VDQogICAgZmV0Y2hEYXRhQnlJZChpZCkgew0KICAgICAgdGVhY2hlcg0KICAgICAgICAuZ2V0QnlJZChpZCkNCiAgICAgICAgLnRoZW4oKHJlc3BvbnNlKSA9PiB7DQogICAgICAgICAgLy9jb25zb2xlLmxvZyhyZXNwb25zZS5kYXRhKTsNCiAgICAgICAgICB0aGlzLnRlYWNoZXIgPSByZXNwb25zZS5kYXRhOw0KICAgICAgICB9KQ0KICAgICAgICAuY2F0Y2goKHJlc3BvbnNlKSA9PiB7DQogICAgICAgICAgdGhpcy4kbWVzc2FnZSh7DQogICAgICAgICAgICB0eXBlOiAiZXJyb3IiLA0KICAgICAgICAgICAgbWVzc2FnZTogIuiOt+WPluaVsOaNruWksei0pSIsDQogICAgICAgICAgfSk7DQogICAgICAgIH0pOw0KICAgIH0sDQoNCiAgICAvLyDkv53lrZjmiJbogIXkv67mlLkNCiAgICBzYXZlT3JVcGRhdGUoKSB7DQogICAgICB0aGlzLnNhdmVCdG5EaXNhYmxlZCA9IHRydWU7DQogICAgICBpZiAoIXRoaXMudGVhY2hlci5pZCkgew0KICAgICAgICB0aGlzLnNhdmVEYXRhKCk7DQogICAgICB9IGVsc2Ugew0KICAgICAgICB0aGlzLnVwZGF0ZURhdGEoKTsNCiAgICAgIH0NCiAgICB9LA0KDQogICAgLy8g5L+d5a2YDQogICAgc2F2ZURhdGEoKSB7DQogICAgICBjb25zb2xlLmxvZyh0aGlzLnRlYWNoZXIpOw0KICAgICAgdGVhY2hlcg0KICAgICAgICAuc2F2ZSh0aGlzLnRlYWNoZXIpDQogICAgICAgIC50aGVuKChyZXNwb25zZSkgPT4gew0KICAgICAgICAgIHJldHVybiB0aGlzLiRtZXNzYWdlKHsNCiAgICAgICAgICAgIHR5cGU6ICJzdWNjZXNzIiwNCiAgICAgICAgICAgIG1lc3NhZ2U6ICLkv53lrZjmiJDlip8hIiwNCiAgICAgICAgICB9KTsNCiAgICAgICAgfSkNCiAgICAgICAgLnRoZW4oKHJlc3Bvc25lKSA9PiB7DQogICAgICAgICAgdGhpcy4kcm91dGVyLnB1c2goeyBwYXRoOiAiL2VkdS90ZWFjaGVyIiB9KTsNCiAgICAgICAgfSkNCiAgICAgICAgLmNhdGNoKChyZXNwb25zZSkgPT4gew0KICAgICAgICAgIC8vIGNvbnNvbGUubG9nKHJlc3BvbnNlKQ0KICAgICAgICAgIHRoaXMuJG1lc3NhZ2Uoew0KICAgICAgICAgICAgdHlwZTogImVycm9yIiwNCiAgICAgICAgICAgIG1lc3NhZ2U6ICLkv53lrZjlpLHotKUiLA0KICAgICAgICAgIH0pOw0KICAgICAgICB9KTsNCiAgICB9LA0KDQogICAgLy8g5qC55o2uaWTmm7TmlrDorrDlvZUNCiAgICB1cGRhdGVEYXRhKCkgew0KICAgICAgdGhpcy5zYXZlQnRuRGlzYWJsZWQgPSB0cnVlOw0KICAgICAgdGVhY2hlcg0KICAgICAgICAudXBkYXRlQnlJZCh0aGlzLnRlYWNoZXIpDQogICAgICAgIC50aGVuKChyZXNwb25zZSkgPT4gew0KICAgICAgICAgIHJldHVybiB0aGlzLiRtZXNzYWdlKHsNCiAgICAgICAgICAgIHR5cGU6ICJzdWNjZXNzIiwNCiAgICAgICAgICAgIG1lc3NhZ2U6ICLkv67mlLnmiJDlip8hIiwNCiAgICAgICAgICB9KTsNCiAgICAgICAgfSkNCiAgICAgICAgLnRoZW4oKHJlc3Bvc25lKSA9PiB7DQogICAgICAgICAgdGhpcy4kcm91dGVyLnB1c2goeyBwYXRoOiAiL2VkdS90ZWFjaGVyIiB9KTsNCiAgICAgICAgfSkNCiAgICAgICAgLmNhdGNoKChyZXNwb25zZSkgPT4gew0KICAgICAgICAgIC8vIGNvbnNvbGUubG9nKHJlc3BvbnNlKQ0KICAgICAgICAgIHRoaXMuJG1lc3NhZ2Uoew0KICAgICAgICAgICAgdHlwZTogImVycm9yIiwNCiAgICAgICAgICAgIG1lc3NhZ2U6ICLkv53lrZjlpLHotKUiLA0KICAgICAgICAgIH0pOw0KICAgICAgICB9KTsNCiAgICB9LA0KDQogICAgLy8g5LiK5Lyg5oiQ5Yqf5ZCO55qE5Zue6LCD5Ye95pWwDQogICAgY3JvcFN1Y2Nlc3MoZGF0YSkgew0KICAgICAgLy8gY29uc29sZS5sb2coZGF0YSk7DQogICAgICB0aGlzLmltYWdlY3JvcHBlclNob3cgPSBmYWxzZTsNCiAgICAgIHRoaXMudGVhY2hlci5hdmF0YXIgPSBkYXRhLnVybDsNCiAgICAgIC8vIOS4iuS8oOaIkOWKn+WQju+8jOmHjeaWsOaJk+W8gOS4iuS8oOe7hOS7tuaXtuWIneWni+WMlue7hOS7tu+8jOWQpuWImeaYvuekuuS4iuS4gOasoeeahOS4iuS8oOe7k+aenA0KICAgICAgdGhpcy5pbWFnZWNyb3BwZXJLZXkgPSB0aGlzLmltYWdlY3JvcHBlcktleSArIDE7DQogICAgfSwNCg0KICAgIC8vIOWFs+mXreS4iuS8oOe7hOS7tg0KICAgIGNsb3NlKCkgew0KICAgICAgdGhpcy5pbWFnZWNyb3BwZXJTaG93ID0gZmFsc2U7DQogICAgICAvLyDkuIrkvKDlpLHotKXlkI7vvIzph43mlrDmiZPlvIDkuIrkvKDnu4Tku7bml7bliJ3lp4vljJbnu4Tku7bvvIzlkKbliJnmmL7npLrkuIrkuIDmrKHnmoTkuIrkvKDnu5PmnpwNCiAgICAgIHRoaXMuaW1hZ2Vjcm9wcGVyS2V5ID0gdGhpcy5pbWFnZWNyb3BwZXJLZXkgKyAxOw0KICAgIH0sDQogIH0sDQp9Ow0K"},{"version":3,"sources":["form.vue"],"names":[],"mappings":";;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;AAoEA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA","file":"form.vue","sourceRoot":"src/views/edu/teacher","sourcesContent":["\r\n<template>\r\n  <div class=\"app-container\">\r\n    <el-form label-width=\"120px\">\r\n      <el-form-item label=\"讲师名称\">\r\n        <el-input v-model=\"teacher.name\" />\r\n      </el-form-item>\r\n      <el-form-item label=\"讲师排序\">\r\n        <el-input-number\r\n          v-model=\"teacher.sort\"\r\n          controls-position=\"right\"\r\n          :min=\"0\"\r\n        />\r\n      </el-form-item>\r\n      <el-form-item label=\"讲师头衔\">\r\n        <el-select v-model=\"teacher.level\" clearable placeholder=\"请选择\">\r\n          <!--\r\n            数据类型一定要和取出的json中的一致，否则没法回填\r\n            因此，这里value使用动态绑定的值，保证其数据类型是number\r\n          -->\r\n          <el-option :value=\"1\" label=\"高级讲师\" />\r\n          <el-option :value=\"2\" label=\"首席讲师\" />\r\n        </el-select>\r\n      </el-form-item>\r\n      <el-form-item label=\"讲师资历\">\r\n        <el-input v-model=\"teacher.career\" />\r\n      </el-form-item>\r\n      <el-form-item label=\"讲师简介\">\r\n        <el-input v-model=\"teacher.intro\" :rows=\"10\" type=\"textarea\" />\r\n      </el-form-item>\r\n\r\n      <!-- 讲师头像 -->\r\n      <el-form-item label=\"讲师头像\">\r\n        <!-- 头衔缩略图 -->\r\n        <pan-thumb :image=\"teacher.avatar\" />\r\n        <!-- 文件上传按钮 -->\r\n        <el-button\r\n          type=\"primary\"\r\n          icon=\"el-icon-upload\"\r\n          @click=\"imagecropperShow = true\"\r\n          >更换头像\r\n        </el-button>\r\n        <!--\r\n        v-show：是否显示上传组件\r\n        :key：类似于id，如果一个页面多个图片上传控件，可以做区分\r\n        :url：后台上传的url地址\r\n        @close：关闭上传组件\r\n        @crop-upload-success：上传成功后的回调 -->\r\n        <image-cropper\r\n          v-show=\"imagecropperShow\"\r\n          :width=\"300\"\r\n          :height=\"300\"\r\n          :key=\"imagecropperKey\"\r\n          :url=\"BASE_API + '/eduoss/fileupload/upload'\"\r\n          field=\"file\"\r\n          @close=\"close\"\r\n          @crop-upload-success=\"cropSuccess\"\r\n        />\r\n      </el-form-item>\r\n\r\n      <el-form-item>\r\n        <el-button :disabled=\"saveBtnDisabled\" type=\"primary\" @click=\"saveOrUpdate\">保存</el-button>\r\n      </el-form-item>\r\n    </el-form>\r\n  </div>\r\n</template>\r\n\r\n<script>\r\nimport teacher from \"@/api/edu/teacher\";\r\nimport ImageCropper from \"@/components/ImageCropper\";\r\nimport PanThumb from \"@/components/PanThumb\";\r\n\r\nconst defaultForm = {\r\n  name: \"\",\r\n  sort: 0,\r\n  level: \"\",\r\n  career: \"\",\r\n  intro: \"\",\r\n  avatar: \"\",\r\n};\r\n\r\nexport default {\r\n  data() {\r\n    return {\r\n      teacher: {\r\n        name: \"\",\r\n        sort: 0,\r\n        level: 1,\r\n        career: \"\",\r\n        intro: \"\",\r\n        avatar: process.env.OSS_PATH + \"/TeacherHeadPortrait/默认头像.jpg\",\r\n      },\r\n      saveBtnDisabled: false, // 保存按钮是否禁用,\r\n      BASE_API: process.env.VUE_APP_BASE_API, // 接口API地址\r\n      imagecropperShow: false, // 是否显示上传组件\r\n      imagecropperKey: 0, // 上传组件id\r\n    };\r\n  },\r\n  components: {\r\n    ImageCropper: ImageCropper,\r\n    PanThumb: PanThumb,\r\n  },\r\n\r\n  watch: {\r\n    $route(to, from) {\r\n      console.log(\"watch $route\");\r\n      this.init();\r\n    },\r\n  },\r\n\r\n  created() {\r\n    //console.log('created')\r\n    this.init();\r\n  },\r\n\r\n  methods: {\r\n    init() {\r\n      if (this.$route.params && this.$route.params.id) {\r\n        const id = this.$route.params.id;\r\n        this.fetchDataById(id);\r\n      } else {\r\n        // 使用对象拓展运算符，拷贝对象，而不是引用，\r\n        // 否则新增一条记录后，defaultForm就变成了之前新增的teacher的值\r\n        this.teacher = { ...defaultForm };\r\n      }\r\n    },\r\n\r\n    // 根据id查询记录\r\n    fetchDataById(id) {\r\n      teacher\r\n        .getById(id)\r\n        .then((response) => {\r\n          //console.log(response.data);\r\n          this.teacher = response.data;\r\n        })\r\n        .catch((response) => {\r\n          this.$message({\r\n            type: \"error\",\r\n            message: \"获取数据失败\",\r\n          });\r\n        });\r\n    },\r\n\r\n    // 保存或者修改\r\n    saveOrUpdate() {\r\n      this.saveBtnDisabled = true;\r\n      if (!this.teacher.id) {\r\n        this.saveData();\r\n      } else {\r\n        this.updateData();\r\n      }\r\n    },\r\n\r\n    // 保存\r\n    saveData() {\r\n      console.log(this.teacher);\r\n      teacher\r\n        .save(this.teacher)\r\n        .then((response) => {\r\n          return this.$message({\r\n            type: \"success\",\r\n            message: \"保存成功!\",\r\n          });\r\n        })\r\n        .then((resposne) => {\r\n          this.$router.push({ path: \"/edu/teacher\" });\r\n        })\r\n        .catch((response) => {\r\n          // console.log(response)\r\n          this.$message({\r\n            type: \"error\",\r\n            message: \"保存失败\",\r\n          });\r\n        });\r\n    },\r\n\r\n    // 根据id更新记录\r\n    updateData() {\r\n      this.saveBtnDisabled = true;\r\n      teacher\r\n        .updateById(this.teacher)\r\n        .then((response) => {\r\n          return this.$message({\r\n            type: \"success\",\r\n            message: \"修改成功!\",\r\n          });\r\n        })\r\n        .then((resposne) => {\r\n          this.$router.push({ path: \"/edu/teacher\" });\r\n        })\r\n        .catch((response) => {\r\n          // console.log(response)\r\n          this.$message({\r\n            type: \"error\",\r\n            message: \"保存失败\",\r\n          });\r\n        });\r\n    },\r\n\r\n    // 上传成功后的回调函数\r\n    cropSuccess(data) {\r\n      // console.log(data);\r\n      this.imagecropperShow = false;\r\n      this.teacher.avatar = data.url;\r\n      // 上传成功后，重新打开上传组件时初始化组件，否则显示上一次的上传结果\r\n      this.imagecropperKey = this.imagecropperKey + 1;\r\n    },\r\n\r\n    // 关闭上传组件\r\n    close() {\r\n      this.imagecropperShow = false;\r\n      // 上传失败后，重新打开上传组件时初始化组件，否则显示上一次的上传结果\r\n      this.imagecropperKey = this.imagecropperKey + 1;\r\n    },\r\n  },\r\n};\r\n</script>"]}]}